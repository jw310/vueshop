{"remainingRequest":"/Users/lchick1003/Documents/vue3esite/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lchick1003/Documents/vue3esite/src/views/CustomerOrders.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lchick1003/Documents/vue3esite/src/views/CustomerOrders.vue","mtime":1575265462000},{"path":"/Users/lchick1003/Documents/vue3esite/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lchick1003/Documents/vue3esite/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lchick1003/Documents/vue3esite/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lchick1003/Documents/vue3esite/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport $ from \"jquery\"; // 因為此元件無法使用 $，所以要先 import 才能使用\n\n\n export default {\n    data() {\n        return {\n            products: [],\n            product: {},\n            carts: {},\n            total: 0,\n            final_total: 0,\n            form: {\n                user: {\n                    name: '',\n                    email: '',\n                    tel: '',\n                    address: '',\n                },\n                message: '',\n            },\n            isLoading: false,\n            coupon_code: ''\n        };\n    },\n    methods: {\n    getProducts() { \n      const vm = this;\n      const api = `https://vue-course-api.hexschool.io/api/jw310/products`;\n      //const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/products`;\n      vm.loading = true;\n      this.$http.get(api).then(response => {\n      console.log(response.data);\n        vm.products = response.data.products; \n        vm.loading = false;\n      });\n     },\n     getProduct(id) {   // 查看更多\n      const vm = this;                                                                     \n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/product/${id}`;\n      vm.status.loadingItem = id;\n      this.$http.get(api).then(response => { \n        //console.log(response);\n        vm.product = response.data.product;\n        $('#productModal').modal('show');\n        vm.status.loadingItem = '';\n      }); \n     },\n     getCart() {  // 取得購物車資料\n      const vm = this;                                                                     \n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/cart`;\n      vm.isLoading = true;\n      this.$http.get(api).then(response => { \n      console.log(response.data.data);\n      vm.carts = response.data.data.carts;\n      vm.total = response.data.data.total;\n      vm.final_total = response.data.data.final_total;\n      vm.isLoading = false;\n      }); \n     },\n     removeCartItem(id) {\n      const vm = this;                                                                     \n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/cart/${id}`;\n      vm.isLoading = true;\n      this.$http.delete(api).then(response => { \n      //console.log(response);\n      //vm.carts = response.data.data.carts;\n      this.getCart();\n      vm.isLoading = false;\n      }); \n     },\n    //  addCouponCode() {\n    //   const vm = this;                                                                     \n    //   const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/coupon`;\n    //   const coupon = {\n    //       code: vm.coupon_code,\n    //   }\n    //   vm.isLoading = true;\n    //   this.$http.delete(api, { data: coupon }).then(response => { \n    //   this.getCart();\n    //   vm.isLoading = false;\n    //   }); \n    //  },\n     createOrder() {\n      const vm = this;                                                                     \n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/order`;\n      const order = vm.form;\n      //vm.isLoading = true;\n      this.$validator.validate().then((result) => {  // veevalidate的驗證方法\n        if (result) {\n            this.$http.post(api, { data: order }).then(response => {  // 自訂義\n            console.log('訂單已建立', response);\n            if (response.data.success) {\n              vm.$router.push(`/customercheckout/${response.data.orderId}`);\n            }  \n            //this.getCart();\n            vm.isLoading = false;\n           }); \n         } else {\n             console.log('欄位不完整');\n         }\n      });\n     },\n   },       \n    created() {\n    this.getProducts();\n    this.getCart();   // 取得購物車資料\n   } \n}\n",{"version":3,"sources":["CustomerOrders.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyFA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CustomerOrders.vue","sourceRoot":"src/views","sourcesContent":["<template>\n<div>\n    <loading :active.sync=\"isLoading\"></loading> <!--讀取效果-->\n    <!-- cart list-->\n    <table class=\"table\">\n      <thead>\n        <tr>\n          <th></th>  \n          <th>產品名稱</th>\n          <th>數量</th>\n          <th>單價</th>\n        </tr>\n      </thead>\n      <tbody>\n        <!--key 會產生警告(有 eslint 的話)，因為此時沒有資料，但不影響使用-->\n        <tr v-for=\"(item, key) in carts\" :key=\"item.id\"> \n          <td width=\"20px\">\n          <button type=\"button\" class=\"btn btn-outline-danger btn-sm\"\n          @click=\"removeCartItem(item.id)\">\n              <i class=\"fas fa-trash-alt\"></i>\n          </button>\n          </td>\n          <td width=\"100px\">{{item.product.title}}\n             <div class=\"text-success\" v-if=\"item.coupon\">\n                 已使用優惠券\n             </div>\n          </td>\n          <td width=\"50px\">{{item.qty}}/{{item.product.unit}}</td>\n          <td width=\"50px\" align=\"right\">{{ item.total | currency}}</td>\n        </tr>\n      </tbody>\n      <tfoot>\n      <tr>\n          <td colspan=\"3\" align=\"right\">原價</td>\n          <td align=\"right\">{{this.total}}</td>\n        </tr>\n          <tr v-if=\"this.final_total !== this.total\">  <!-- 有折扣時才出現 -->\n          <td colspan=\"3\" align=\"right\" class=\"text-success\">折扣價</td>\n          <td align=\"right\" class=\"text-success\">{{this.final_total}}</td>\n        </tr>\n      </tfoot>\n    </table>\n        <!-- <div class='input-group mb-3 input-group-sm '>\n          <input type=\"text\" class=\"text-right\" placeholder=\"請輸入優惠碼\">\n            <div>\n            <button class=\"btn btn-lg btn-primary btn-block\" type=\"button\"\n            @click=\"addCouponCode\">送出</button>\n            </div> \n        </div> -->\n    <!-- 送出表單 -->\n<div class=\"my-5 row justify-content-center\">\n  <form class=\"col-md-6\" @submit.prevent=\"createOrder\">\n    <div class=\"form-group\">\n      <label for=\"useremail\">Email</label>\n      <input type=\"email\" class=\"form-control\" name=\"email\" id=\"useremail\"\n        v-model=\"form.user.email\" placeholder=\"請輸入 Email\" required>\n      <span class=\"text-danger\">\n      </span>\n    </div>\n  \n    <div class=\"form-group\">\n      <label for=\"username\">收件人姓名</label>\n      <input type=\"text\" class=\"form-control\" name=\"name\" id=\"username\"\n        v-model=\"form.user.name\" v-validate=\"'required'\" placeholder=\"輸入姓名\">\n    </div>\n  \n    <div class=\"form-group\">\n      <label for=\"usertel\">收件人電話</label>\n      <input type=\"tel\" class=\"form-control\" id=\"usertel\" name=\"phoneNubmer\" v-model=\"form.user.tel\">\n    </div>\n  \n    <div class=\"form-group\">\n      <label for=\"useraddress\">收件人地址</label>\n      <input type=\"text\" class=\"form-control\" name=\"address\" id=\"useraddress\" v-model=\"form.user.address\">\n    </div>\n  \n    <div class=\"form-group\">\n      <label for=\"comment\">留言</label>\n      <textarea name=\"\" id=\"comment\" class=\"form-control\" cols=\"30\" rows=\"10\" v-model=\"form.message\"></textarea>\n    </div>\n    <div class=\"text-right\">\n      <button class=\"btn btn-danger\">送出訂單</button>\n    </div>\n  </form>\n</div>\n</div>   \n</template>\n\n<script>\nimport $ from \"jquery\"; // 因為此元件無法使用 $，所以要先 import 才能使用\n\n\n export default {\n    data() {\n        return {\n            products: [],\n            product: {},\n            carts: {},\n            total: 0,\n            final_total: 0,\n            form: {\n                user: {\n                    name: '',\n                    email: '',\n                    tel: '',\n                    address: '',\n                },\n                message: '',\n            },\n            isLoading: false,\n            coupon_code: ''\n        };\n    },\n    methods: {\n    getProducts() { \n      const vm = this;\n      const api = `https://vue-course-api.hexschool.io/api/jw310/products`;\n      //const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/products`;\n      vm.loading = true;\n      this.$http.get(api).then(response => {\n      console.log(response.data);\n        vm.products = response.data.products; \n        vm.loading = false;\n      });\n     },\n     getProduct(id) {   // 查看更多\n      const vm = this;                                                                     \n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/product/${id}`;\n      vm.status.loadingItem = id;\n      this.$http.get(api).then(response => { \n        //console.log(response);\n        vm.product = response.data.product;\n        $('#productModal').modal('show');\n        vm.status.loadingItem = '';\n      }); \n     },\n     getCart() {  // 取得購物車資料\n      const vm = this;                                                                     \n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/cart`;\n      vm.isLoading = true;\n      this.$http.get(api).then(response => { \n      console.log(response.data.data);\n      vm.carts = response.data.data.carts;\n      vm.total = response.data.data.total;\n      vm.final_total = response.data.data.final_total;\n      vm.isLoading = false;\n      }); \n     },\n     removeCartItem(id) {\n      const vm = this;                                                                     \n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/cart/${id}`;\n      vm.isLoading = true;\n      this.$http.delete(api).then(response => { \n      //console.log(response);\n      //vm.carts = response.data.data.carts;\n      this.getCart();\n      vm.isLoading = false;\n      }); \n     },\n    //  addCouponCode() {\n    //   const vm = this;                                                                     \n    //   const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/coupon`;\n    //   const coupon = {\n    //       code: vm.coupon_code,\n    //   }\n    //   vm.isLoading = true;\n    //   this.$http.delete(api, { data: coupon }).then(response => { \n    //   this.getCart();\n    //   vm.isLoading = false;\n    //   }); \n    //  },\n     createOrder() {\n      const vm = this;                                                                     \n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/order`;\n      const order = vm.form;\n      //vm.isLoading = true;\n      this.$validator.validate().then((result) => {  // veevalidate的驗證方法\n        if (result) {\n            this.$http.post(api, { data: order }).then(response => {  // 自訂義\n            console.log('訂單已建立', response);\n            if (response.data.success) {\n              vm.$router.push(`/customercheckout/${response.data.orderId}`);\n            }  \n            //this.getCart();\n            vm.isLoading = false;\n           }); \n         } else {\n             console.log('欄位不完整');\n         }\n      });\n     },\n   },       \n    created() {\n    this.getProducts();\n    this.getCart();   // 取得購物車資料\n   } \n}\n</script>\n\n<style scoped>\n.table {\n  width: 50%;\n  /* 置中 */ \n  margin-left:auto;   \n  margin-right:auto;\n}\n\n.form-coupon {\n  width: 30%;\n  /* 置中 */ \n  margin-left:auto;   \n  margin-right:auto;\n}\n\n/* .form-control {\n    display: inline-block;\n} */\n\ninput {\n    cursor: pointer;\n    border-radius: 5px;\n    padding:5px 15px;\n    border:1px black solid; \n}\n\n.coupon {\n    white-space: nowrap; \n}\n\nth {\n  align-content: right;\n}\n\n</style>\n"]}]}