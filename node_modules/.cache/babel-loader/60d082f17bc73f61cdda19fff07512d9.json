{"remainingRequest":"/Users/lchick1003/Documents/vue3esite/node_modules/babel-loader/lib/index.js!/Users/lchick1003/Documents/vue3esite/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lchick1003/Documents/vue3esite/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lchick1003/Documents/vue3esite/src/views/Products.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lchick1003/Documents/vue3esite/src/views/Products.vue","mtime":1575280347000},{"path":"/Users/lchick1003/Documents/vue3esite/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lchick1003/Documents/vue3esite/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lchick1003/Documents/vue3esite/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lchick1003/Documents/vue3esite/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport $ from \"jquery\"; // 因為此元件無法使用 $ ，所以要先 import 才能使用\n\nexport default {\n  data: function data() {\n    return {\n      products: [],\n      pagination: {},\n      tempProduct: {},\n      // modal 資料\n      isNew: false,\n      deleteId: \"\",\n      isLoading: false,\n      // 讀取效果\n      status: {\n        fileUploading: false\n      }\n    };\n  },\n  methods: {\n    getProducts: function getProducts() {\n      var page = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      // ES6 變數預設值\n      var vm = this;\n      var api = 'https://vue-course-api.hexschool.io/api/jw310/admin/products?page=${page}`'; //const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/admin/products?page=${page}`;\n      //console.log(process.env.VUE_APP_APIPATH, process.env.VUE_APP_CUSTOMPATH);  // 看路徑是否正確\n\n      vm.isLoading = true;\n      this.$http.get(api).then(function (response) {\n        // vue 下才能使用\n        //console.log(response.data);   // api 回覆訊息\n        vm.isLoading = false;\n        vm.products = response.data.products;\n        vm.pagination = response.data.pagination; // 分頁資訊\n        //console.log(vm.products);\n      });\n    },\n    openModal: function openModal(isNew, item) {\n      //$('#productModal').modal('show'); //  確認有資料才 openModal\n      if (isNew) {\n        this.tempProduct = {};\n        this.isNew = true;\n      } else {\n        // ES6 方法 Object.assign()\n        this.tempProduct = Object.assign({}, item); // 如果直接 this.tempProduct = item，會有傳參考的特性\n\n        this.isNew = false;\n      }\n\n      $(\"#productModal\").modal(\"show\");\n    },\n    updateProduct: function updateProduct() {\n      //updata API\n      var api = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMPATH, \"/admin/product\");\n      var httpMethod = \"post\";\n      var vm = this; //console.log(process.env.APIPATH, process.env.CUSTOMPATH);  // 看路徑是否正確\n      // { data: vm.tempProduct } 因為接收資料的型態要是物件\n\n      if (!vm.isNew) {\n        api = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMPATH, \"/admin/product/\").concat(vm.tempProduct.id);\n        httpMethod = \"put\";\n      }\n\n      this.$http[httpMethod](api, {\n        data: vm.tempProduct\n      }).then(function (response) {\n        console.log(response.data);\n\n        if (response.data.success) {\n          $(\"#productModal\").modal(\"hide\"); // 成功地關閉 modal\n\n          vm.getProducts();\n        } else {\n          $(\"#productModal\").modal(\"hide\"); // 成功地關閉 modal\n\n          vm.getProducts();\n          console.log(\"新增失敗\");\n        }\n      });\n    },\n    delModal: function delModal(item) {\n      $(\"#delProductModal\").modal(\"show\");\n      this.deleteId = item.id; // 取得點選的 item.id\n      //console.log(item.id);\n    },\n    deleteProduct: function deleteProduct() {\n      var vm = this; //console.log(vm.index);\n\n      var api = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMPATH, \"/admin/product/\").concat(vm.deleteId);\n      this.$http.delete(api).then(function (response) {\n        //console.log(response.data);\n        if (response.data.success) {\n          $(\"#delProductModal\").modal(\"hide\"); // 成功地關閉 modal\n\n          console.log(\"刪除成功\");\n          vm.getProducts();\n        } else {\n          $(\"#delProductModal\").modal(\"hide\"); // 成功地關閉 modal\n\n          vm.getProducts();\n          console.log(\"刪除失敗\");\n        }\n      });\n    },\n    signout: function signout() {\n      //  對應 config 裡的 dev.env.js 的環境變數\n      //const api = 'https://vue-course-api.hexschool.io/logout';\n      var api = \"\".concat(process.env.VUE_APP_APIPATH, \"/logout\"); // api 伺服器路徑\n      // 申請apipath\n\n      var vm = this;\n      this.$http.post(api).then(function (response) {\n        console.log(response.data);\n\n        if (response.data.success) {\n          vm.$router.push('/login'); // 登入回到首頁\n        }\n      });\n    },\n    uploadFile: function uploadFile() {\n      // 上傳圖片\n      //console.log(this);\n      var uploadedFile = this.$refs.files.files[0];\n      var vm = this;\n      var formData = new FormData(); //  表單送出方法，建立物件\n\n      formData.append(\"file-to-upload\", uploadedFile); // 新增欄位\n\n      var url = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMPATH, \"/admin/upload\");\n      vm.status.fileUploading = true;\n      this.$http.post(url, formData, {\n        headers: {\n          \"content-Type\": \"multipart/form-data\" // 改上傳格式為 form-data\n\n        }\n      }).then(function (response) {\n        console.log(response.data);\n        vm.status.fileUploading = false;\n\n        if (response.data.success) {\n          // vm.tempProduct.imageUrl = response.data.imageUrl; // 此時資訊並沒有完整寫入\n          //console.log(vm.tempProduct.imageUrl);\n          vm.$set(vm.tempProduct, \"imageUrl\", response.data.imageUrl); // 雙向綁定，強制寫入資訊\n        } else {//this.$bus.$emit(\"message:push\", response.data.message, \"danger\"); // 內層觸發\n          }\n      });\n    }\n  },\n  created: function created() {\n    this.getProducts();\n  }\n};",{"version":3,"sources":["Products.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <loading :active.sync=\"isLoading\"></loading>\n      <nav class=\"navbar navbar-expand-lg navbar-light bg-light\">\n      <h6 class=\"d-flex justify-content-between align-items-center mt-4 mb-4 text-muted\">\n              <span>管理介面</span>\n              <a class=\"d-flex align-items-center text-muted\" href=\"#\">\n                <span data-feather=\"plus-circle\"></span>\n              </a>\n            </h6>\n            <ul class=\"nav flex-column\">\n              <li class=\"nav-item\">\n              <router-link class=\"nav-link\" to=\"/admin/products\">\n                  產品列表\n                </router-link>\n              </li>\n            </ul>\n            <ul class=\"nav flex-column\">\n              <li class=\"nav-item\">\n                <router-link class=\"nav-link\" to=\"/admin/orders\">\n                  訂單列表\n                </router-link>\n              </li>\n            </ul>\n            <ul class=\"nav flex-column\">\n              <li class=\"nav-item\">\n                <router-link class=\"nav-link\" to=\"/admin/coupons\">\n                  優惠券\n                </router-link>\n              </li>\n            </ul>\n            <ul class=\"nav flex-column\">\n              <li class=\"nav-item\">\n                <a href=\"#\" @click.prevent=\"signout\">登出</a>\n              </li>\n            </ul>\n      <div class=\"text-right mt-1\">\n                 <!-- 傳值讓  isNew = true -->\n      </div>\n    </nav>\n    <!-- <span>產品列表</span> -->\n    <button class=\"btn btn-primary\" @click=\"openModal(true)\">建立新產品</button>\n    <table class=\"table mt-4\">\n      <thead>\n        <tr>\n          <th width=\"120\">分類</th>\n          <th>產品名稱</th>\n          <th width=\"120\">原價</th>\n          <th width=\"120\">售價</th>\n          <th width=\"100\">是否啟用</th>\n          <th width=\"80\">編輯</th>\n        </tr>\n      </thead>\n      <tbody>\n        <!--key 會產生警告(有 eslint 的話)，因為此時沒有資料，但不影響使用-->\n        <tr v-for=\"(item, key) in products\" :key=\"item.id\">\n          <td>{{item.category}}</td>\n          <td>{{item.title}}</td>\n          <td class=\"text-right\">{{item.origin_price | currency}}</td>\n          <td class=\"text-right\">{{item.price | currency}}</td>\n          <td>\n            <span v-if=\"item.is_enabled\" class=\"text-success\">啟用</span>\n            <span v-else>未啟用</span>\n          </td>\n          <td>\n            <div style=\"display: inline-block;width: 100px;\">\n              <button class=\"btn btn-outline-primary btn-sm\" @click=\"openModal(false, item)\">編輯</button>\n              <button class=\"btn btn-outline-primary btn-sm\" @click=\"delModal(item)\">刪除</button>\n            </div>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <nav aria-label=\"Page navigation example\">\n      <ul class=\"pagination\">\n        <li class=\"page-item\" :class=\"{'disable': !pagination.has_pre}\">\n          <a\n            class=\"page-link\"\n            href=\"#\"\n            aria-label=\"Previous\"\n            @click.prevent=\"getProducts(pagination.current_page - 1)\"\n          >\n            <span aria-hidden=\"true\">&laquo;</span>\n            <span class=\"sr-only\">Previous</span>\n          </a>\n        </li>\n        <li\n          class=\"page-item\"\n          v-for=\"page in pagination.total_pages\"\n          :key=\"page\"\n          :class=\"{'active': pagination.current_page === page}\"\n        >\n          <a class=\"page-link\" href=\"#\" @click.prevent=\"getProducts(page)\">{{ page }}</a>\n        </li>\n        <li class=\"page-item\">\n          <a\n            class=\"page-link\"\n            href=\"#\"\n            aria-label=\"Next\"\n            @click.prevent=\"getProducts(pagination.current_page + 1)\"\n          >\n            <span aria-hidden=\"true\">&raquo;</span>\n            <span class=\"sr-only\">Next</span>\n          </a>\n        </li>\n      </ul>\n    </nav>\n    <!-- Modal -->\n    <div\n      class=\"modal fade\"\n      id=\"productModal\"\n      tabindex=\"-1\"\n      role=\"dialog\"\n      aria-labelledby=\"exampleModalLabel\"\n      aria-hidden=\"true\"\n    >\n      <div class=\"modal-dialog modal-lg\" role=\"document\">\n        <div class=\"modal-content border-0\">\n          <div class=\"modal-header bg-dark text-white\">\n            <h5 class=\"modal-title\" id=\"exampleModalLabel\">\n              <span>新增產品</span>\n            </h5>\n            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n          </div><div class=\"modal-body\">\n            <div class=\"row\">\n              <div class=\"col-sm-4\">\n                <div class=\"form-group\">\n                  <label for=\"image\">輸入圖片網址</label>\n                  <input\n                    type=\"text\"\n                    class=\"form-control\"\n                    id=\"image\"\n                    v-model=\"tempProduct.imageUrl\"\n                    placeholder=\"請輸入圖片連結\"\n                  />\n                </div>\n          \n                <div class=\"form-group\">\n                  <label for=\"customFile\">\n                    或 上傳圖片\n                    <i class=\"fas fa-spinner fa-spin\" v-if=\"status.fileUploading\"></i>\n                  </label>\n                  <input\n                    type=\"file\"\n                    id=\"customFile\"\n                    class=\"form-control\"\n                    ref=\"files\"\n                    @change=\"uploadFile\"\n                  />\n                </div>\n                <img\n                  class=\"img-fluid\"\n                  :src=\"tempProduct.imageUrl\"\n                  alt\n                />\n              </div>\n              <div class=\"col-sm-8\">\n                <div class=\"form-group\">\n                  <label for=\"title\">標題</label>\n                  <input\n                    type=\"text\"\n                    class=\"form-control\"\n                    id=\"title\"\n                    v-model=\"tempProduct.title\"\n                    placeholder=\"請輸入標題\"\n                  />\n                </div>\n                <div class=\"form-row\">\n                  <div class=\"form-group col-md-6\">\n                    <label for=\"category\">分類</label>\n                    <input\n                      type=\"text\"\n                      class=\"form-control\"\n                      id=\"category\"\n                      v-model=\"tempProduct.category\"\n                      placeholder=\"請輸入分類\"\n                    />\n                  </div>\n                  <div class=\"form-group col-md-6\">\n                    <label for=\"price\">單位</label>\n                    <input\n                      type=\"unit\"\n                      class=\"form-control\"\n                      id=\"unit\"\n                      v-model=\"tempProduct.unit\"\n                      placeholder=\"請輸入單位\"\n                    />\n                  </div>\n                </div>\n\n                <div class=\"form-row\">\n                  <div class=\"form-group col-md-6\">\n                    <label for=\"origin_price\">原價</label>\n                    <input\n                      type=\"number\"\n                      class=\"form-control\"\n                      id=\"origin_price\"\n                      v-model=\"tempProduct.origin_price\"\n                      placeholder=\"請輸入原價\"\n                    />\n                  </div>\n                  <div class=\"form-group col-md-6\">\n                    <label for=\"price\">售價</label>\n                    <input\n                      type=\"number\"\n                      class=\"form-control\"\n                      id=\"price\"\n                      v-model=\"tempProduct.price\"\n                      placeholder=\"請輸入售價\"\n                    />\n                    \n                  </div>\n                </div>\n                <hr />\n                <div class=\"form-group\">\n                  <label for=\"description\">產品描述</label>\n                  <textarea\n                    type=\"text\"\n                    class=\"form-control\"\n                    id=\"description\"\n                    v-model=\"tempProduct.description\"\n                    placeholder=\"請輸入產品描述\"\n                  ></textarea>\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"content\">說明內容</label>\n                  <textarea\n                    type=\"text\"\n                    class=\"form-control\"\n                    id=\"content\"\n                    v-model=\"tempProduct.content\"\n                    placeholder=\"請輸入產品說明內容\"\n                  ></textarea>\n                </div>\n                <div class=\"form-group\">\n                  <div class=\"form-check\">\n                    <input\n                      class=\"form-check-input\"\n                      type=\"checkbox\"\n                      v-model=\"tempProduct.is_enabled\"\n                      :true-value=\"1\"\n                      :false-value=\"0\"\n                      id=\"is_enabled\"\n                    />\n                    <label class=\"form-check-label\" for=\"is_enabled\">是否啟用</label>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-outline-secondary\" data-dismiss=\"modal\">取消</button>\n            <button type=\"button\" class=\"btn btn-primary\" @click=\"updateProduct\">確認</button>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div\n      class=\"modal fade\"\n      id=\"delProductModal\"\n      tabindex=\"-1\"\n      role=\"dialog\"\n      aria-labelledby=\"exampleModalLabel\"\n      aria-hidden=\"true\"\n    >\n      <div class=\"modal-dialog\" role=\"document\">\n        <div class=\"modal-content border-0\">\n          <div class=\"modal-header bg-danger text-white\">\n            <h5 class=\"modal-title\" id=\"exampleModalLabel\">\n              <span>刪除產品</span>\n            </h5>\n            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n          </div>\n          <div class=\"modal-body\">\n            是否刪除\n            <strong class=\"text-danger\">{{ tempProduct.title }}</strong> 商品(刪除後將無法恢復)。\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-outline-secondary\" data-dismiss=\"modal\">取消</button>\n            <button type=\"button\" class=\"btn btn-danger\" @click=\"deleteProduct\">確認刪除</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>   \n\n\n\n<script>\nimport $ from \"jquery\"; // 因為此元件無法使用 $ ，所以要先 import 才能使用\n\nexport default {\n  data() {\n    return {\n      products: [],\n      pagination: {},\n      tempProduct: {}, // modal 資料\n      isNew: false,\n      deleteId: \"\",\n      isLoading: false, // 讀取效果\n      status: {\n        fileUploading: false\n      }\n    };\n  },\n  methods: {\n    getProducts(page = 1) {\n      // ES6 變數預設值\n      const vm = this;\n      const api = 'https://vue-course-api.hexschool.io/api/jw310/admin/products?page=${page}`'\n      //const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/admin/products?page=${page}`;\n      //console.log(process.env.VUE_APP_APIPATH, process.env.VUE_APP_CUSTOMPATH);  // 看路徑是否正確\n      vm.isLoading = true;\n      this.$http.get(api).then(response => {\n        // vue 下才能使用\n        //console.log(response.data);   // api 回覆訊息\n        vm.isLoading = false;\n        vm.products = response.data.products;\n        vm.pagination = response.data.pagination; // 分頁資訊\n        //console.log(vm.products);\n      });\n    },\n    openModal(isNew, item) {\n      //$('#productModal').modal('show'); //  確認有資料才 openModal\n      if (isNew) {\n        this.tempProduct = {};\n        this.isNew = true;\n      } else {\n        // ES6 方法 Object.assign()\n        this.tempProduct = Object.assign({}, item); // 如果直接 this.tempProduct = item，會有傳參考的特性\n        this.isNew = false;\n      }\n      $(\"#productModal\").modal(\"show\");\n    },\n    updateProduct() {\n      //updata API\n      let api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/admin/product`;\n      let httpMethod = \"post\";\n      const vm = this;\n      //console.log(process.env.APIPATH, process.env.CUSTOMPATH);  // 看路徑是否正確\n      // { data: vm.tempProduct } 因為接收資料的型態要是物件\n      if (!vm.isNew) {\n        api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/admin/product/${vm.tempProduct.id}`;\n        httpMethod = \"put\";\n      }\n      this.$http[httpMethod](api, { data: vm.tempProduct }).then(response => {\n        console.log(response.data);\n        if (response.data.success) {\n          $(\"#productModal\").modal(\"hide\"); // 成功地關閉 modal\n          vm.getProducts();\n        } else {\n          $(\"#productModal\").modal(\"hide\"); // 成功地關閉 modal\n          vm.getProducts();\n          console.log(\"新增失敗\");\n        }\n      });\n    },\n    delModal(item) {\n      $(\"#delProductModal\").modal(\"show\");\n      this.deleteId = item.id; // 取得點選的 item.id\n      //console.log(item.id);\n    },\n    deleteProduct() {\n      const vm = this;\n      //console.log(vm.index);\n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/admin/product/${vm.deleteId}`;\n      this.$http.delete(api).then(response => {\n        //console.log(response.data);\n        if (response.data.success) {\n          $(\"#delProductModal\").modal(\"hide\"); // 成功地關閉 modal\n          console.log(\"刪除成功\");\n          vm.getProducts();\n        } else {\n          $(\"#delProductModal\").modal(\"hide\"); // 成功地關閉 modal\n          vm.getProducts();\n          console.log(\"刪除失敗\");\n        }\n      });\n    },\n    signout() {\n   //  對應 config 裡的 dev.env.js 的環境變數\n   //const api = 'https://vue-course-api.hexschool.io/logout';\n   const api = `${process.env.VUE_APP_APIPATH}/logout` ;\n   // api 伺服器路徑\n   // 申請apipath\n   const vm = this;\n   this.$http.post(api).then((response) => {\n   console.log(response.data);\n   if (response.data.success) {\n          vm.$router.push('/login');    // 登入回到首頁\n        } \n      });\n    },\n    uploadFile() {\n      // 上傳圖片\n      //console.log(this);\n      const uploadedFile = this.$refs.files.files[0];\n      const vm = this;\n      const formData = new FormData(); //  表單送出方法，建立物件\n      formData.append(\"file-to-upload\", uploadedFile);   // 新增欄位\n      const url = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/admin/upload`;\n      vm.status.fileUploading = true;\n      this.$http.post(url, formData, {\n          headers: {\n            \"content-Type\": \"multipart/form-data\" // 改上傳格式為 form-data\n          }\n        }).then(response => {\n          console.log(response.data);\n          vm.status.fileUploading = false;\n          if (response.data.success) {\n            // vm.tempProduct.imageUrl = response.data.imageUrl; // 此時資訊並沒有完整寫入\n            //console.log(vm.tempProduct.imageUrl);\n            vm.$set(vm.tempProduct, \"imageUrl\", response.data.imageUrl); // 雙向綁定，強制寫入資訊\n          } else {\n            //this.$bus.$emit(\"message:push\", response.data.message, \"danger\"); // 內層觸發\n          }\n        });\n    }\n  },\n  created() {\n    this.getProducts();\n  }\n};\n</script>\n"],"sourceRoot":"src/views"}]}